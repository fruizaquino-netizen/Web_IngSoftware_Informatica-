<section class="egresados-container">

  <header class="egresados-header">
    <h1>{{ content().EGRESADOS.TITLE }}</h1>
    <p>
      {{ content().EGRESADOS.SUBTITLE }}
    </p>
  </header>

  <section class="egresados-section">
    <h2>{{ content().EGRESADOS.BY_YEAR }}</h2>

    <div class="egresados-cards">
      <div class="card-anio"
           *ngFor="let anio of aniosDisponibles()"
           (click)="abrirModalPorAnio(anio)">
        <span class="anio">{{ anio }}</span>
        <span class="cantidad">
          {{ conteoPorAnio()[anio] }}
          {{ conteoPorAnio()[anio] === 1 ? content().EGRESADOS.SINGULAR : content().EGRESADOS.PLURAL }}
        </span>
      </div>
    </div>
  </section>

  <section class="egresados-section">
    <h2>{{ content().EGRESADOS.BY_MODALITY }}</h2>

    <div class="filtros">
      <button class="filtro"
              [class.activo]="filtroActivo() === 'todos'"
              (click)="cambiarFiltro('todos')">
        {{ getFiltroLabel('todos') }}
      </button>

      <button class="filtro"
              [class.activo]="filtroActivo() === 'tesis'"
              (click)="cambiarFiltro('tesis')">
        {{ getFiltroLabel('tesis') }}
      </button>

      <button class="filtro"
              [class.activo]="filtroActivo() === 'ceneval'"
              (click)="cambiarFiltro('ceneval')">
        {{ getFiltroLabel('ceneval') }}
      </button>

      <button class="filtro"
              [class.activo]="filtroActivo() === 'experiencia'"
              (click)="cambiarFiltro('experiencia')">
        {{ getFiltroLabel('experiencia') }}
      </button>
    </div>
  </section>

  <div class="total-egresados">
    <span class="total-label">
      {{ content().EGRESADOS.TOTAL_PREFIX }}
      {{
        filtroActivo() === 'todos'
          ? content().EGRESADOS.TOTAL_REGISTERED
          : content().EGRESADOS.TOTAL_IN_MODALITY + ' ' + getFiltroLabel(filtroActivo())
      }}
    </span>

    <span class="total-badge">
      {{ totalSegunFiltro() }}
    </span>
  </div>

  <section class="egresados-section">
    <h2>{{ content().EGRESADOS.LIST_TITLE }}</h2>

    <div class="tabla-container">
      <table>
        <thead>
          <tr>
            <th>{{ content().EGRESADOS.TABLE_NAME }}</th>
            <th>{{ content().EGRESADOS.TABLE_YEAR }}</th>
            <th>{{ content().EGRESADOS.TABLE_MODALITY }}</th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let e of egresadosFiltrados()">
            <td>{{ e.nombre }}</td>
            <td>{{ e.anio }}</td>
            <td>
              <span class="badge">{{ getFiltroLabel(e.modalidad) }}</span>
            </td>
          </tr>

          <tr *ngIf="egresadosFiltrados().length === 0">
            <td colspan="3" style="text-align: center; padding: 20px;">
              {{ content().EGRESADOS.NO_RESULTS }}
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </section>

</section>
<div class="modal-overlay" *ngIf="anioSeleccionado()" (click)="cerrarModal()">

  <div class="modal-content" (click)="$event.stopPropagation()">

    <div class="modal-header">
      <h3>{{ content().EGRESADOS.MODAL_TITLE }} {{ anioSeleccionado() }}</h3>
      <button class="btn-cerrar" type="button" aria-label="Cerrar" (click)="cerrarModal()">×</button>
    </div>

    <div class="modal-body">
      <table class="modal-table">
        <thead>
          <tr>
            <th>{{ content().EGRESADOS.TABLE_NAME }}</th>
            <th>{{ content().EGRESADOS.TABLE_MODALITY }}</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let e of egresadosPorAnioSeleccionado()">
            <td>{{ e.nombre }}</td>
            <td>
              <span class="badge">{{ getFiltroLabel(e.modalidad) }}</span>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

  </div>
</div>
